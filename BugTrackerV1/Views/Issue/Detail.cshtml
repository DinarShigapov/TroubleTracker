@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@section VendorScripts {
    <script src="~/vendor/js/issue-script.js"></script>
}

@section VendorStyles {
    <link rel="stylesheet" href="~/vendor/css/pages/issue-style.css" />
}

@model BugTrackerV1.Models.ViewModel.Issue.DetailIssueViewModel

<div class="container-fluid">
    <div class="bg-light task-main p-4 py-4 rounded-3">
        <form asp-controller="Issue" asp-action="Detail">
          <div class="row task-details">
            <div class="col-md-8">
                <div class="form-group">
                    <label>Название задачи:</label>
                    <label>@Model.Title</label>
                </div>
                <div class="form-group">
                    <label for="taskDescription">Описание задачи:</label>
                    <label>@Model.Description</label>
                </div>

                <div class="form-group">
                    <label for="taskDueDate">Вложения:</label>
                    <div id="scrollable">
                        <div id="fileList">
                            @foreach (var file in Model.Attachments)
                            {
                                <div class="attachment-box">
                                    @if (file.FileFormat.StartsWith(".png"))
                                    {
                                        <img src="@Url.Action("GetFile","Issue", new { fileName = file.FilePath })" class="img-fluid" alt="Image" />
                                    }
                                    else
                                    {
                                        <div class="attachment-file">Файл</div>
                                    }
                                </div>

                            }
                        </div>
                    </div>
                </div>
                 <div class="form-group">
                        <h4 class="mt-4">Активность</h4>
                        <div class="btn-group mb-3" role="group" aria-label="Activity buttons">
                            <button type="button" class="btn btn-secondary" onclick="showActivity('all')">Все</button>
                            <button type="button" class="btn btn-secondary" onclick="showActivity('comments')">Комментарии</button>
                            <button type="button" class="btn btn-secondary" onclick="showActivity('history')">История</button>
                        </div>

                        <div id="all-activities" class="activity-content">
                            <div id="commentList"></div>
                            <div id="historyContent">No history available.</div>
                            <div id="worklogContent">No work log available.</div>
                        </div>

                        <div id="comments" class="activity-content d-none">
                            <h5>Добавить комментарий</h5>
                            <form onsubmit="addComment(event)">
                                <div class="form-group">
                                    <textarea id="newComment" class="form-control" rows="3"></textarea>
                                </div>
                                <button type="button" class="btn mt-3 btn-primary">Отправить</button>
                            </form>
                            <h5 class="mt-3">Комментарии</h5>
                            <div id="commentList"></div>
                        </div>

                        <div id="history" class="activity-content d-none">
                            <h5>История изменений</h5>
                            <p>No history available.</p>
                        </div>
                    </div>
            </div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Дополнительная информация</h5>
                        <div class="form-group">
                            <label>Исполнитель:</label>
                            <label></label>
                        </div>
                        <div class="form-group">
                            <label asp-for="CreatedBy">Автор:</label>
                            <label>@Model.CreatedBy</label>
                        </div>
                        <div class="form-group">
                            <label for="taskLabels">Метки:</label>
                            @if (Model.Labels != null)
                            {
                            @foreach (var item in Model.Labels)
                                {
                            <div>@item.Text</div>
                                }
                            }
                        </div>
                        <div class="form-group">
                            <label asp-for="Priority">Приоритет:</label>
                            <label>@Model.Priority</label>
                        </div>
                        @Html.Hidden("Id", Model.Id)
                            <label asp-for="SprintId">Тип задачи:</label>
                            <select class="form-control" asp-for="SprintId" asp-items="Model.Sprints">
                                <option value="NOSELECTEDVALUE">Выберите спринт</option>
                            </select>
                            <button type="submit" class="btn btn-primary" id="saveButton">Сохранить</button>

                    </div>
                </div>
            </div>
        </div>
        </form>
    </div>
</div>